#! /bin/csh


#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-
#                                                                        
#    3dDeconvolve Regression
#
#    Auto-generated by ScriptWriter.py
#    kiefer katovich 2012
#
#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-

#-#-#-#-#-#-#-#-#-#-#-		Subjects					-#-#-#-#-#-#-#-#-#-#-#

set subjects = ( test )

#-#-#-#-#-#-#-#-#-#-#-		SID 						-#-#-#-#-#-#-#-#-#-#-#

#-#-#-#-#-#-#-#-#-#-#-		Cycle through subjects:		-#-#-#-#-#-#-#-#-#-#-#

echo starting to process SID

foreach subject ( ${subjects} )

    cd ../data/${subject}*
    echo processing ${subject} 

#-#-#-#-#-#-#-#-#-#-#-		Run makeVec on model file:		-#-#-#-#-#-#-#-#-#-#-#
	
	/mnt/c/Users/Michael/fMRI/cultsid/scripts/makeVec.py /mnt/c/Users/Michael/fMRI/cultsid/scripts/sid_vecs_full.txt ${subject}
	
#-#-#-#-#-#-#-#-#-#-#-		Run waver on vectors:		-#-#-#-#-#-#-#-#-#-#-#

	waver -dt 2.0 -GAM -numout 384 -input ant_sid.1D > ant_sidc.1D
	waver -dt 2.0 -GAM -numout 384 -input out_sid.1D > out_sidc.1D
	waver -dt 2.0 -GAM -numout 384 -input gvnant_sid.1D > gvnant_sidc.1D
	waver -dt 2.0 -GAM -numout 384 -input lvnant_sid.1D > lvnant_sidc.1D
	waver -dt 2.0 -GAM -numout 384 -input hgvnout_sid.1D > hgvnout_sidc.1D
    waver -dt 2.0 -GAM -numout 384 -input mgvnout_sid.1D > mgvnout_sidc.1D
    waver -dt 2.0 -GAM -numout 384 -input lgvnout_sid.1D > lgvnout_sidc.1D
	waver -dt 2.0 -GAM -numout 384 -input nvhlout_sid.1D > nvhlout_sidc.1D
    waver -dt 2.0 -GAM -numout 384 -input nvmlout_sid.1D > nvmlout_sidc.1D
    waver -dt 2.0 -GAM -numout 384 -input nvllout_sid.1D > nvllout_sidc.1D

#-#-#-#-#-#-#-#-#-#-#-		Clean old regression file:		-#-#-#-#-#-#-#-#-#-#-#

	if ( -e sid_reg_csfwm+orig.BRIK ) then
		rm -rf sid_reg_csfwm+orig*
	endif
	
	cp -f //mnt/c/Users/Michael/fMRI/cultsid/scripts/sid_runs.1D ./

#-#-#-#-#-#-#-#-#-#-#-		Run 3dDeconvolve:		-#-#-#-#-#-#-#-#-#-#-#

	3dDeconvolve -float -jobs 8 -input sid_mbnf+orig -jobs 6 -concat sid_runs.1D -nfirst 0 -num_stimts 12 -polort 1 \
		-stim_file 1 '3dmotionsid.1D[1]' -stim_label 1 'roll' \
		-stim_file 2 '3dmotionsid.1D[2]' -stim_label 2 'pitch' \
		-stim_file 3 '3dmotionsid.1D[3]' -stim_label 3 'yaw' \
		-stim_file 4 '3dmotionsid.1D[4]' -stim_label 4 'dS' \
		-stim_file 5 '3dmotionsid.1D[5]' -stim_label 5 'dL' \
		-stim_file 6 '3dmotionsid.1D[6]' -stim_label 6 'dP' \
		-stim_file 7 'bsid_mbnf_csf_mask.1D' -stim_label 7 'csf' \
		-stim_file 8 'bsid_mbnf_wm_mask.1D' -stim_label 8 'wm' \
		-stim_file 9 'ant_sidc.1D' -stim_label 9 'ant' \
		-stim_file 10 'out_sidc.1D' -stim_label 10 'out' \
		-stim_file 11 'gvnant_sidc.1D' -stim_label 11 'gvnant' \
		-stim_file 12 'lvnant_sidc.1D' -stim_label 12 'lvnant' \
		#-stim_file 13 'hgvnout_sidc.1D' -stim_label 13 'hgvnout' \
		#-stim_file 14 'mgvnout_sidc.1D' -stim_label 14 'mgvnout' \
        #-stim_file 15 'lgvnout_sidc.1D' -stim_label 15 'lgvnout' \
		#-stim_file 16 'nvhlout_sidc.1D' -stim_label 16 'nvhlout' \
        #-stim_file 17 'nvmlout_sidc.1D' -stim_label 17 'nvmlout' \
        #-stim_file 18 'nvllout_sidc.1D' -stim_label 18 'nvllout' \
		-tout -fout -bucket sid_reg_csfwm
	
#-#-#-#-#-#-#-#-#-#-#-		Write zscored dataset:		-#-#-#-#-#-#-#-#-#-#-#

	if ( -e zsid_reg_csfwm+orig.BRIK ) then
		rm -rf zsid_reg_csfwm+orig*
	endif
	
	3dmerge -doall -1zscore -prefix zsid_reg_csfwm sid_reg_csfwm+orig

#-#-#-#-#-#-#-#-#-#-#-		Remove non-zscored dataset:		-#-#-#-#-#-#-#-#-#-#-#

	rm -rf sid_reg_csfwm+orig*
	
end




#-#-#-#-#-#-#-#-#-#-#-		MID 						-#-#-#-#-#-#-#-#-#-#-#

echo starting to process MID

foreach subject ( ${subjects} )

    cd ../${subject}*
    echo processing ${subject} 

#-#-#-#-#-#-#-#-#-#-#-		Run makeVec on model file:		-#-#-#-#-#-#-#-#-#-#-#
	
	/mnt/c/Users/Michael/fMRI/cultsid/scripts/makeVec.py /mnt/c/Users/Michael/fMRI/cultsid/scripts/mid_vecs_full.txt ${subject}
	
#-#-#-#-#-#-#-#-#-#-#-		Run waver on vectors:		-#-#-#-#-#-#-#-#-#-#-#

	waver -dt 2.0 -GAM -numout 384 -input ant_mid.1D > ant_midc.1D
	waver -dt 2.0 -GAM -numout 384 -input out_mid.1D > out_midc.1D
	waver -dt 2.0 -GAM -numout 384 -input gvnant_mid.1D > gvnant_midc.1D
	waver -dt 2.0 -GAM -numout 384 -input lvnant_mid.1D > lvnant_midc.1D
	waver -dt 2.0 -GAM -numout 384 -input hgvnout_mid.1D > hgvnout_midc.1D
    waver -dt 2.0 -GAM -numout 384 -input mgvnout_mid.1D > mgvnout_midc.1D
    waver -dt 2.0 -GAM -numout 384 -input lgvnout_mid.1D > lgvnout_midc.1D
	waver -dt 2.0 -GAM -numout 384 -input nvhlout_mid.1D > nvhlout_midc.1D
    waver -dt 2.0 -GAM -numout 384 -input nvmlout_mid.1D > nvmlout_midc.1D
    waver -dt 2.0 -GAM -numout 384 -input nvllout_mid.1D > nvllout_midc.1D

#-#-#-#-#-#-#-#-#-#-#-		Clean old regression file:		-#-#-#-#-#-#-#-#-#-#-#

	if ( -e mid_reg_csfwm+orig.BRIK ) then
		rm -rf mid_reg_csfwm+orig*
	endif
	
	cp -f //mnt/c/Users/Michael/fMRI/cultsid/scripts/mid_runs.1D ./

#-#-#-#-#-#-#-#-#-#-#-		Run 3dDeconvolve:		-#-#-#-#-#-#-#-#-#-#-#

	3dDeconvolve -float -jobs 8 -input mid_mbnf+orig -jobs 6 -concat mid_runs.1D -nfirst 0 -num_stimts 12 -polort 1 \
		-stim_file 1 '3dmotionmid.1D[1]' -stim_label 1 'roll' \
		-stim_file 2 '3dmotionmid.1D[2]' -stim_label 2 'pitch' \
		-stim_file 3 '3dmotionmid.1D[3]' -stim_label 3 'yaw' \
		-stim_file 4 '3dmotionmid.1D[4]' -stim_label 4 'dS' \
		-stim_file 5 '3dmotionmid.1D[5]' -stim_label 5 'dL' \
		-stim_file 6 '3dmotionmid.1D[6]' -stim_label 6 'dP' \
		-stim_file 7 'bmid_mbnf_csf_mask.1D' -stim_label 7 'csf' \
		-stim_file 8 'bmid_mbnf_wm_mask.1D' -stim_label 8 'wm' \
		-stim_file 9 'ant_midc.1D' -stim_label 9 'ant' \
		-stim_file 10 'out_midc.1D' -stim_label 10 'out' \
		-stim_file 11 'gvnant_midc.1D' -stim_label 11 'gvnant' \
		-stim_file 12 'lvnant_midc.1D' -stim_label 12 'lvnant' \
		#-stim_file 13 'hgvnout_midc.1D' -stim_label 13 'hgvnout' \
		#-stim_file 14 'mgvnout_midc.1D' -stim_label 14 'mgvnout' \
        #-stim_file 15 'lgvnout_midc.1D' -stim_label 15 'lgvnout' \
		#-stim_file 16 'nvhlout_midc.1D' -stim_label 16 'nvhlout' \
        #-stim_file 17 'nvmlout_midc.1D' -stim_label 17 'nvmlout' \
        #-stim_file 18 'nvllout_midc.1D' -stim_label 18 'nvllout' \
		-tout -fout -bucket mid_reg_csfwm
	
#-#-#-#-#-#-#-#-#-#-#-		Write zscored dataset:		-#-#-#-#-#-#-#-#-#-#-#

	if ( -e zmid_reg_csfwm+orig.BRIK ) then
		rm -rf zmid_reg_csfwm+orig*
	endif
	
	3dmerge -doall -1zscore -prefix zmid_reg_csfwm mid_reg_csfwm+orig

#-#-#-#-#-#-#-#-#-#-#-		Remove non-zscored dataset:		-#-#-#-#-#-#-#-#-#-#-#

	rm -rf mid_reg_csfwm+orig*
	
end
